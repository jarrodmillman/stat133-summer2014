load('mydoxorubicin07.rda')
library(class)
my.knn = function(train, test, status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    gknn$mean = mean(gknn == status)
    gknn$table = table(gknn, status)
}
raw.knn = my.knn(train$raw, test$raw, train$status)
raw.knn = my.knn(train$log, test$log, train$status)
train$status
train$log
gene.knn = knn(t(train$raw), t(test$raw), train$status, k=2, prob=TRUE)
my.knn(train$raw, test$raw, train$status)
my.knn = function(train, test, status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
#    gknn$mean = mean(gknn == status)
#    gknn$table = table(gknn, status)
}
my.knn(train$raw, test$raw, train$status)
my.knn = function(train, test, status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    gknn$mean = mean(gknn == status)
#    gknn$table = table(gknn, status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, train$status)
my.knn = function(train, test, status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    attr(gknn, "table") = table(gknn, status)
    attr(gknn, "mean") = mean(gknn == status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, train$status)
my.knn = function(train, test, status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    length(gknn)
    length(status)
    attr(gknn, "table") = table(gknn, status)
    attr(gknn, "mean") = mean(gknn == status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, train$status)
my.knn = function(train, test, status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    length(gknn)
    length(status)
    #attr(gknn, "table") = table(gknn, status)
    attr(gknn, "mean") = mean(gknn == status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, train$status)
gene.knn = knn(t(train$raw), t(test$raw), train$status, k=2, prob=TRUE)
mean(gene.knn == test$status)
table(gene.knn, test$status)
attr(gene.knn, "table")
attr(gene.knn, "table") = table(gene.knn, test$status)
attr(gene.knn, "table")
my.knn = function(train, test, status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    length(gknn)
    length(status)
    #attr(gknn, "table") = table(gknn, status)
    #attr(gknn, "mean") = mean(gknn == status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, train$status)
my.knn = function(train, test, status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    print(length(gknn))
    print(length(status))
    #attr(gknn, "table") = table(gknn, status)
    #attr(gknn, "mean") = mean(gknn == status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, train$status)
my.knn = function(train, test, test.status, status=train$status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    attr(gknn, "table") = table(gknn, test.status)
    attr(gknn, "mean") = mean(gknn == test.status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, train$status)
my.knn = function(train, test, test.status, status=train$status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    attr(gknn, "table") = table(gknn, test.status)
    attr(gknn, "mean") = mean(gknn == test.status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, test$status)
my.knn = function(train, test, test.status, status=train$status) {
    gknn = knn(t(train), t(test), status, k=2, prob=TRUE)
    print(length(gknn))
    print(length(test.status))
    #attr(gknn, "table") = table(gknn, test.status)
    #attr(gknn, "mean") = mean(gknn == test.status)
    return(gknn)
}
raw.knn = my.knn(train$raw, test$raw, test$status)
train$status
train$raw
