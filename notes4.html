<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Section Notes - 4 - Stat 133 (summer 2014)</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
        <meta property="og:site_name" content="Stat 133 (summer 2014)" />
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Section Notes - 4"/>
            <meta property="og:url" content="http://www.jarrodmillman.com/stat133-summer2014/notes4.html"/>
            <meta property="og:description" content="Apply functions in R R&#39;s apply functions are the efficient way to perform repeated operations on vectors of your data. There are many variants of the &#34;apply&#34; statement as well as wrappers for special cases of these functions easier. These notes will cover the apply statements and wrappers that ..."/>
            <meta property="article:published_time" content="2014-06-25" />
                <meta property="article:section" content="misc" />
                <meta property="article:author" content="Karl Kumbier" />

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://www.jarrodmillman.com/stat133-summer2014/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://www.jarrodmillman.com/stat133-summer2014/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://www.jarrodmillman.com/stat133-summer2014/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://www.jarrodmillman.com/stat133-summer2014/theme/css/style.css" type="text/css"/>

        <link href="http://www.jarrodmillman.com/stat133-summer2014/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Stat 133 (summer 2014) ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://www.jarrodmillman.com/stat133-summer2014/" class="navbar-brand">
Stat 133 (summer 2014)            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="http://www.jarrodmillman.com/stat133-summer2014/pages/about.html">About</a></li>
                    <li><a href="http://www.jarrodmillman.com/stat133-summer2014/pages/lectures.html">Lectures</a></li>
                    <li><a href="http://www.jarrodmillman.com/stat133-summer2014/pages/software.html">Software</a></li>
                    <li><a href="https://piazza.com/berkeley/summer2014/statistics133/home">Discussion</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://www.jarrodmillman.com/stat133-summer2014/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://www.jarrodmillman.com/stat133-summer2014/notes4.html"
                       rel="bookmark"
                       title="Permalink to Section Notes - 4">
                        Section Notes - 4
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2014-06-25T00:00:00"> Wed 25 June 2014</time>
    </span>



    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h1>Apply functions in R</h1>
<p><code>R</code>'s <code>apply</code> functions are the efficient way to perform repeated
operations on vectors of your data. There are many variants of the "apply"
statement as well as wrappers for special cases of these
functions easier. These notes will cover the <code>apply</code> statements and
wrappers that are most commonly used in data analysis. Much of what we discuss
here carries over to other <code>apply</code> statements as well.</p>
<h2><code>apply</code></h2>
<p>The first function we'll look at is <code>apply</code>. This function applies a given
function to each element of a data structure with defined dimension
(i.e. matrices, arrays, data frames). The elements that <code>apply</code> operates on are
the rows/columns of matrices and data frames (or the sub-matrices of arrays). In
other words, if you want to apply some function to the rows or columns of your
data, you should use the <code>apply</code> function. When you call <code>apply</code>, you must
supply the function with the object you want to operate on (<code>X</code>), the dimension(s)
you would like to apply the function over (<code>MARGIN</code>), and the function you would
like to perform (<code>FUN</code>). There are a few things to note about these arguments
before proceeding to our examples.</p>
<ul>
<li>
<p><code>X</code> must have positive dimension. You can easily check this by running
dim(<code>X</code>). Note that vectors and lists do not satisfy this requirement.</p>
</li>
<li>
<p>For the <code>MARGIN</code> argument, 1 indicates rows and 2 indicates columns. If you
are using higher dimensional arrays, integers that correspond to any of the
other dimensions are accepatable as well.</p>
</li>
<li>
<p>you may specify additional arguments to your function following the <code>FUN</code>
argument.</p>
</li>
</ul>
<p><code>apply</code> will return the vector, matrix or list that results from applying <code>FUN</code>
to each row or column as defined by <code>MARGIN</code>. Whenever possible, <code>apply</code> will
try to simplify the results of its return into a matrix or vector. If <code>FUN</code>
returns objects with different lengths when applied to the various rows/columns,
the returned object will be a list. Lets look at a few examples.</p>
<div class="highlight"><pre>sample.matrix <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kp">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">15</span><span class="p">,</span> <span class="m">15</span><span class="p">),</span> ncol <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
sample.matrix
</pre></div>


<div class="highlight"><pre>##      [,1] [,2] [,3] [,4] [,5]
## [1,]   15    8   12   10    2
## [2,]    7   11    5    6   14
## [3,]    3    4   13    1    9
</pre></div>


<div class="highlight"><pre><span class="c1"># basic apply statements that calculate the mean of rows and columns</span>
row.means <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>sample.matrix<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="kp">mean</span><span class="p">)</span>
col.means <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>sample.matrix<span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kp">mean</span><span class="p">)</span>
row.means
</pre></div>


<div class="highlight"><pre>## [1] 9.4 8.6 6.0
</pre></div>


<div class="highlight"><pre>col.means
</pre></div>


<div class="highlight"><pre>## [1]  8.333  7.667 10.000  5.667  8.333
</pre></div>


<div class="highlight"><pre><span class="c1"># faster way to accomplish the same thing</span>
row.means <span class="o">&lt;-</span> <span class="kp">rowMeans</span><span class="p">(</span>sample.matrix<span class="p">)</span>
col.means <span class="o">&lt;-</span> <span class="kp">colMeans</span><span class="p">(</span>sample.matrix<span class="p">)</span>
row.means
</pre></div>


<div class="highlight"><pre>## [1] 9.4 8.6 6.0
</pre></div>


<div class="highlight"><pre>col.means
</pre></div>


<div class="highlight"><pre>## [1]  8.333  7.667 10.000  5.667  8.333
</pre></div>


<p>A few of the functions that are frequently used by statisticians (<code>sum</code>
and <code>mean</code>) have slightly faster implementations of an <code>apply</code> statment used to
do the same thing. However, using an <code>apply</code> statement allows us to pass in
additional arguments.</p>
<div class="highlight"><pre><span class="c1"># you can pass in additional arguments after defining the function. Any</span>
<span class="c1"># arguments not passed in will use the function&#39;s default value</span>

row.means.trimmed <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>sample.matrix<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="kp">mean</span><span class="p">,</span> trim <span class="o">=</span> <span class="m">0.35</span><span class="p">)</span>
col.means.trimmed <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>sample.matrix<span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kp">mean</span><span class="p">,</span> trim <span class="o">=</span> <span class="m">0.35</span><span class="p">)</span>
row.means.trimmed
</pre></div>


<div class="highlight"><pre>## [1] 10.000  8.000  5.333
</pre></div>


<div class="highlight"><pre>col.means.trimmed
</pre></div>


<div class="highlight"><pre>## [1]  7  8 12  6  9
</pre></div>


<p>You can also define your own functions for the <code>FUN</code> argument. User defined
functions will take the row or column as their argument depending on the value
you specified for <code>MARGIN</code>.</p>
<div class="highlight"><pre>overall.mean <span class="o">&lt;-</span> <span class="kp">mean</span><span class="p">(</span>sample.matrix<span class="p">)</span>

row.value <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>sample.matrix<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="kr">function</span><span class="p">(</span><span class="kp">row</span><span class="p">)</span> <span class="p">{</span>
    value <span class="o">&lt;-</span> <span class="p">(</span><span class="kp">mean</span><span class="p">(</span><span class="kp">row</span><span class="p">)</span> <span class="o">-</span> overall.mean<span class="p">)</span><span class="o">/</span>sd<span class="p">(</span><span class="kp">row</span><span class="p">)</span>
    <span class="kr">return</span><span class="p">(</span>value<span class="p">)</span>
<span class="p">})</span>

col.value <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span>sample.matrix<span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kr">function</span><span class="p">(</span><span class="kp">col</span><span class="p">)</span> <span class="p">{</span>
    value <span class="o">&lt;-</span> <span class="p">(</span><span class="kp">mean</span><span class="p">(</span><span class="kp">col</span><span class="p">)</span> <span class="o">-</span> overall.mean<span class="p">)</span><span class="o">/</span>sd<span class="p">(</span><span class="kp">col</span><span class="p">)</span>
    <span class="kr">return</span><span class="p">(</span>value<span class="p">)</span>
<span class="p">})</span>

row.value
</pre></div>


<div class="highlight"><pre>## [1]  0.2870  0.1587 -0.4082
</pre></div>


<div class="highlight"><pre>col.value
</pre></div>


<div class="highlight"><pre>## [1]  0.05455 -0.09492  0.45883 -0.51745  0.05530
</pre></div>


<p>As we mentioned, when our functions return objects of varying lengths <code>apply</code>
will return a list.</p>
<div class="highlight"><pre>param.matrix <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span> ncol <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
param.matrix
</pre></div>


<div class="highlight"><pre>##      [,1] [,2]
## [1,]    5    0
## [2,]   10    5
</pre></div>


<div class="highlight"><pre><span class="c1"># generate a list of length with 5 samples of mean 0 normal variables and 10</span>
<span class="c1"># samples of mean 5 variables</span>
<span class="kp">apply</span><span class="p">(</span>param.matrix<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="kr">function</span><span class="p">(</span><span class="kp">row</span><span class="p">)</span> rnorm<span class="p">(</span><span class="kp">row</span><span class="p">[</span><span class="m">1</span><span class="p">],</span> <span class="kp">row</span><span class="p">[</span><span class="m">2</span><span class="p">]))</span>
</pre></div>


<div class="highlight"><pre>## [[1]]
## [1] -0.2734  0.2565  1.0476  2.1080  0.1782
## 
## [[2]]
##  [1] 5.059 3.139 6.402 6.015 4.699 5.704 4.677 5.341 5.737 4.789
</pre></div>


<h2><code>sapply</code> (<code>lapply</code>)</h2>
<p>The next functions that we will look at are similar to <code>apply</code> in that they
are used to loop over a data structure and apply some function to the elements
of that data structure. Unlike <code>apply</code>, they operate on data structures with
undefined dimension (i.e. lists and vectors). These functions are <code>sapply</code> and
<code>lapply</code>. Actually, <code>sapply</code> is just a wrapper for <code>lapply</code> that tries to
simplify the returned value into a vector or matrix where possible. We use
<code>sapply</code> in our examples with the knowledge that if we wanted to return a list
we could use <code>lapply</code> instead. When you call <code>sapply</code> (or <code>lapply</code>) you need to
supply it with the data structure that will get looped over (<code>X</code>) and a function
to apply to each element of that data structure (<code>FUN</code>). There are a few things
to note</p>
<ul>
<li>Running <code>sapply</code> on a data frame will perform <code>FUN</code> on each of the vectors in
  that comprise it (remember data frames are just lists of vectors of equal
  length).</li>
<li>Running <code>sapply</code> on a matrix or array will coerce the object into a list and
  then apply <code>FUN</code> to the individual elements.</li>
</ul>
<div class="highlight"><pre>sample.list <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">(</span>samp1 <span class="o">=</span> rnorm<span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> samp2 <span class="o">=</span> rnorm<span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span> samp3 <span class="o">=</span> rnorm<span class="p">(</span><span class="m">10</span><span class="p">,</span> 
    <span class="m">10</span><span class="p">))</span>

<span class="c1"># The objects we call sapply on don&#39;t have defined dimension so we don&#39;t</span>
<span class="c1"># need a MARGIN argument. Other than that the function calls are similar</span>

<span class="kp">sapply</span><span class="p">(</span>sample.list<span class="p">,</span> <span class="kp">mean</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre>##   samp1   samp2   samp3 
## -0.4709  4.4661 10.5416
</pre></div>


<div class="highlight"><pre><span class="kp">sapply</span><span class="p">(</span>sample.list<span class="p">,</span> <span class="kp">mean</span><span class="p">,</span> trim <span class="o">=</span> <span class="m">0.35</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre>##   samp1   samp2   samp3 
## -0.3927  4.4029 10.6850
</pre></div>


<div class="highlight"><pre><span class="kp">sapply</span><span class="p">(</span>sample.list<span class="p">,</span> <span class="kr">function</span><span class="p">(</span>list.element<span class="p">)</span> <span class="p">{</span>
    value <span class="o">&lt;-</span> <span class="kp">mean</span><span class="p">(</span>list.element<span class="p">)</span><span class="o">/</span>sd<span class="p">(</span>list.element<span class="p">)</span>
<span class="p">})</span>
</pre></div>


<div class="highlight"><pre>##   samp1   samp2   samp3 
## -0.3283  9.3778  9.5501
</pre></div>


<p>When we call <code>sapply</code> (or <code>lapply</code>) on a data frame it acts on the vectors that
make up the data frame.</p>
<div class="highlight"><pre><span class="c1"># built in R dataset on regional levels of different socioeconomic</span>
<span class="c1"># indicators in Switzerland</span>
<span class="kp">head</span><span class="p">(</span>swiss<span class="p">)</span>
</pre></div>


<div class="highlight"><pre>##              Fertility Agriculture Examination Education Catholic
## Courtelary        80.2        17.0          15        12     9.96
## Delemont          83.1        45.1           6         9    84.84
## Franches-Mnt      92.5        39.7           5         5    93.40
## Moutier           85.8        36.5          12         7    33.77
## Neuveville        76.9        43.5          17        15     5.16
## Porrentruy        76.1        35.3           9         7    90.57
##              Infant.Mortality
## Courtelary               22.2
## Delemont                 22.2
## Franches-Mnt             20.2
## Moutier                  20.3
## Neuveville               20.6
## Porrentruy               26.6
</pre></div>


<div class="highlight"><pre>swiss.subset <span class="o">&lt;-</span> swiss<span class="p">[,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;Fertility&quot;</span><span class="p">,</span> <span class="s">&quot;Agriculture&quot;</span><span class="p">,</span> <span class="s">&quot;Education&quot;</span><span class="p">,</span> <span class="s">&quot;Infant.Mortality&quot;</span><span class="p">)]</span>

<span class="c1"># lets look the mean and standard deviation of each of the variables</span>
<span class="kp">sapply</span><span class="p">(</span>swiss.subset<span class="p">,</span> <span class="kp">mean</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre>##        Fertility      Agriculture        Education Infant.Mortality 
##            70.14            50.66            10.98            19.94
</pre></div>


<div class="highlight"><pre><span class="kp">sapply</span><span class="p">(</span>swiss.subset<span class="p">,</span> sd<span class="p">)</span>
</pre></div>


<div class="highlight"><pre>##        Fertility      Agriculture        Education Infant.Mortality 
##           12.492           22.711            9.615            2.913
</pre></div>


<div class="highlight"><pre><span class="c1"># we can even plot histograms of the data by variable</span>
par<span class="p">(</span>mfrow <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>  <span class="c1"># this is a nice function to put multiple plots on one page</span>
<span class="kp">sapply</span><span class="p">(</span>swiss.subset<span class="p">,</span> hist<span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk unnamed-chunk-6" src="figure/unnamed-chunk-6.png" /> </p>
<p>Unfortunately, the names for the histograms aren't particularly helpful. You
could try to adjust this by supplying additional arguments to the hist function</p>
<div class="highlight"><pre>var.names <span class="o">&lt;-</span> <span class="kp">names</span><span class="p">(</span>swiss.subset<span class="p">)</span>
var.names
</pre></div>


<div class="highlight"><pre>## [1] &quot;Fertility&quot;        &quot;Agriculture&quot;      &quot;Education&quot;       
## [4] &quot;Infant.Mortality&quot;
</pre></div>


<div class="highlight"><pre>par<span class="p">(</span>mfrow <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="kp">sapply</span><span class="p">(</span>swiss.subset<span class="p">,</span> hist<span class="p">,</span> xlab <span class="o">=</span> <span class="s">&quot;observed value&quot;</span><span class="p">,</span> main <span class="o">=</span> var.names<span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk unnamed-chunk-7" src="figure/unnamed-chunk-7.png" /> </p>
<p>Instead of labeling each plotwith the correct variable name, R prints every
string in <code>var.names</code> for each plot. Not exactly what we were looking for. This
is because the functions we apply to the elements of our data structure are
constant. In other words, the only inputs to <code>FUN</code> that change are the elements
of our data structure. Thankfully, R provides the function <code>mapply</code> to help us
get around this.</p>
<h2><code>mapply</code></h2>
<p>The <code>mapply</code> function works much like <code>sapply</code> or <code>lapply</code>. With <code>mapply</code>
though, our functions are not limited to a single varying argument. The call for
<code>mapply</code> is a little different from the other apply functions. We first need to
specify our function then we provide the data structure that the function
operates on. Our histogram example would look something like this:</p>
<div class="highlight"><pre>var.names <span class="o">&lt;-</span> <span class="kp">names</span><span class="p">(</span>swiss.subset<span class="p">)</span>
par<span class="p">(</span>mfrow <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
<span class="kp">mapply</span><span class="p">(</span><span class="kr">function</span><span class="p">(</span>variable<span class="p">,</span> var.name<span class="p">)</span> hist<span class="p">(</span>variable<span class="p">,</span> main <span class="o">=</span> var.name<span class="p">,</span> xlab <span class="o">=</span> <span class="s">&quot;observed value&quot;</span><span class="p">),</span> 
    swiss.subset<span class="p">,</span> var.names<span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk unnamed-chunk-8" src="figure/unnamed-chunk-8.png" /> </p>
<p>Notice that the order we provide the different variables at the end of our
<code>mapply</code> statement needs to be the same as the order they are called in the
function. Further, <code>mapply</code> is not restricted to only two variables. As long as
we make sure the orders correspond we may use as many variables as we like.</p>
<h2>Apply wrappers: <code>by</code> and <code>replicate</code></h2>
<p>Some apply function tasks are so common amongst R users that the language
includes wrappers for them. Chief among these are <code>by</code> and <code>replicate</code>. <code>by</code>
statements are useful when trying to run functions on various subsets of your
data. Consider the "mtcars" dataset that is built into R and suppose we wanted
to calculate the average mpg of a car by number of cylinders in the engine.</p>
<div class="highlight"><pre><span class="kp">head</span><span class="p">(</span>mtcars<span class="p">)</span>
</pre></div>


<div class="highlight"><pre>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
</pre></div>


<div class="highlight"><pre><span class="c1"># the arguments for a by statment are data, subset factor, function in that</span>
<span class="c1"># order</span>
<span class="kp">by</span><span class="p">(</span>mtcars<span class="o">$</span>mpg<span class="p">,</span> mtcars<span class="o">$</span>cyl<span class="p">,</span> <span class="kp">mean</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span class="cp">##</span><span class="c"> mtcars$cyl: 4</span><span class="x"></span>
<span class="cp">##</span><span class="c"> [1] 26.66</span><span class="x"></span>
<span class="cp">##</span><span class="c"> -------------------------------------------------------- </span><span class="x"></span>
<span class="cp">##</span><span class="c"> mtcars$cyl: 6</span><span class="x"></span>
<span class="cp">##</span><span class="c"> [1] 19.74</span><span class="x"></span>
<span class="cp">##</span><span class="c"> -------------------------------------------------------- </span><span class="x"></span>
<span class="cp">##</span><span class="c"> mtcars$cyl: 8</span><span class="x"></span>
<span class="cp">##</span><span class="c"> [1] 15.1</span><span class="x"></span>
</pre></div>


<div class="highlight"><pre><span class="c1"># we can use sapply statement to look at the average of several variables by</span>
<span class="c1"># number of cylinders</span>
<span class="kp">sapply</span><span class="p">(</span>mtcars<span class="p">[,</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;mpg&quot;</span><span class="p">,</span> <span class="s">&quot;hp&quot;</span><span class="p">,</span> <span class="s">&quot;wt&quot;</span><span class="p">)],</span> <span class="kr">function</span><span class="p">(</span>var<span class="p">)</span> <span class="kp">by</span><span class="p">(</span>var<span class="p">,</span> mtcars<span class="o">$</span>cyl<span class="p">,</span> <span class="kp">mean</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre>##     mpg     hp    wt
## 4 26.66  82.64 2.286
## 6 19.74 122.29 3.117
## 8 15.10 209.21 3.999
</pre></div>


<p><code>replicate</code> statements are useful for simulations and fairly simple to
implement. These statements produce a specified number of replicates of a given
statement. For instance, if we wanted to produce 10 simulations of sampling 25
random uniform variables</p>
<div class="highlight"><pre><span class="kp">replicate</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> runif<span class="p">(</span><span class="m">25</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre>##            [,1]    [,2]    [,3]    [,4]    [,5]   [,6]    [,7]    [,8]
##  [1,] 0.5748392 0.28749 0.00349 0.44652 0.13699 0.3699 0.51512 0.69841
##  [2,] 0.0010590 0.93278 0.47812 0.87892 0.35814 0.3688 0.77206 0.40563
##  [3,] 0.0001907 0.89475 0.87006 0.78308 0.70703 0.3261 0.42233 0.14024
##  [4,] 0.3188565 0.47157 0.86951 0.13302 0.91671 0.2523 0.86594 0.86434
##  [5,] 0.9853210 0.81585 0.45488 0.40766 0.90607 0.6450 0.47121 0.12542
##  [6,] 0.7024356 0.90947 0.46666 0.53455 0.69911 0.2381 0.62024 0.94814
##  [7,] 0.2249691 0.66061 0.70574 0.47489 0.73907 0.2238 0.55454 0.61841
##  [8,] 0.1353921 0.20309 0.27294 0.05341 0.42293 0.9872 0.47972 0.49680
##  [9,] 0.4470449 0.44555 0.24052 0.05491 0.08967 0.6046 0.17333 0.27853
## [10,] 0.9385163 0.67798 0.95618 0.99885 0.45088 0.1313 0.97006 0.07001
## [11,] 0.0982774 0.50816 0.56374 0.94642 0.49484 0.7884 0.77314 0.63851
## [12,] 0.2711856 0.86542 0.54552 0.20941 0.12294 0.7534 0.63229 0.27112
## [13,] 0.4084631 0.37047 0.48257 0.78127 0.80352 0.3549 0.08938 0.35646
## [14,] 0.3299767 0.99052 0.89554 0.68312 0.74825 0.3454 0.71481 0.37773
## [15,] 0.9147518 0.37893 0.17761 0.18310 0.35805 0.6820 0.26136 0.86034
## [16,] 0.4389611 0.11486 0.20609 0.37435 0.74195 0.0718 0.76355 0.30815
## [17,] 0.5641979 0.12247 0.86493 0.22845 0.53164 0.7486 0.23534 0.70235
## [18,] 0.9340997 0.11293 0.68794 0.76306 0.68938 0.4741 0.77426 0.29306
## [19,] 0.7925815 0.65003 0.09922 0.08144 0.46391 0.3626 0.91598 0.03533
## [20,] 0.5656450 0.46962 0.49972 0.04007 0.04784 0.8274 0.50144 0.48898
## [21,] 0.1160394 0.30752 0.92019 0.57434 0.68835 0.1342 0.18251 0.36334
## [22,] 0.0960271 0.66276 0.14329 0.08054 0.98979 0.4877 0.93420 0.96727
## [23,] 0.0618901 0.21379 0.27903 0.32398 0.71879 0.8374 0.35423 0.78674
## [24,] 0.3905563 0.66687 0.95751 0.20393 0.94135 0.7348 0.14536 0.76835
## [25,] 0.8456175 0.08976 0.15553 0.13075 0.74546 0.6280 0.23254 0.62025
##          [,9]   [,10]
##  [1,] 0.30124 0.68865
##  [2,] 0.67112 0.72139
##  [3,] 0.56038 0.99757
##  [4,] 0.23748 0.59152
##  [5,] 0.07987 0.50159
##  [6,] 0.63697 0.91020
##  [7,] 0.71425 0.58123
##  [8,] 0.07934 0.18153
##  [9,] 0.91799 0.85539
## [10,] 0.77144 0.37545
## [11,] 0.43682 0.64109
## [12,] 0.55022 0.43939
## [13,] 0.74331 0.58395
## [14,] 0.01913 0.72981
## [15,] 0.20714 0.95380
## [16,] 0.24238 0.55779
## [17,] 0.16606 0.59220
## [18,] 0.13465 0.03029
## [19,] 0.74797 0.40250
## [20,] 0.11388 0.11504
## [21,] 0.04791 0.58220
## [22,] 0.69066 0.83256
## [23,] 0.00699 0.73928
## [24,] 0.49927 0.18991
## [25,] 0.91362 0.01659
</pre></div><script type= "text/javascript">
    if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
        var mathjaxscript = document.createElement('script');
        mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
        mathjaxscript.type = 'text/javascript';
        mathjaxscript.src = 'https:' == document.location.protocol
                ? 'https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'
                : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
        mathjaxscript[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" +
            "    config: ['MMLorHTML.js']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    displayAlign: 'center'," +
            "    displayIndent: '0em'," +
            "    showMathMenu: true," +
            "    tex2jax: { " +
            "        inlineMath: [ ['$','$'] ], " +
            "        displayMath: [ ['$$','$$'] ]," +
            "        processEscapes: true," +
            "        preview: 'TeX'," +
            "    }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
    }
</script>

            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">



    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://www.r-project.org/" target="_blank">
                R home
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://cran.r-project.org/manuals.html" target="_blank">
                R docs
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://rseek.org/" target="_blank">
                R seek
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://software-carpentry.org" target="_blank">
                Software Carpentry
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 K. Jarrod Millman
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://www.jarrodmillman.com/stat133-summer2014/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://www.jarrodmillman.com/stat133-summer2014/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://www.jarrodmillman.com/stat133-summer2014/theme/js/respond.min.js"></script>

</body>
</html>